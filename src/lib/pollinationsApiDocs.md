# Pollinations.AI API Documentation

## Core Endpoints

### Image Generation

`GET https://image.pollinations.ai/prompt/{prompt}`

- **Description:** Generate an image from a text prompt
- **Parameters:**
  - `prompt` (required): The text description of the image you want to generate
  - `width` (optional): Width of the generated image (default: 512)
  - `height` (optional): Height of the generated image (default: 512)
  - `seed` (optional): Seed for reproducible results (default: random)
  - `model` (optional): The model to use for generation
    - Options: 'flux', 'flux-realism', 'any-dark', 'flux-anime', 'flux-3d', 'turbo' (default: 'flux')
  - `nologo` (optional): Set to true to disable the logo rendering

- **Example:**
```
https://image.pollinations.ai/prompt/A%20beautiful%20sunset%20over%20mountains?width=1024&height=768&seed=42&model=flux
```

### Text Generation

`POST https://text.pollinations.ai/`

- **Description:** Generate text using language models
- **Headers:** `Content-Type: application/json`
- **Body Parameters:**
  - `prompt` or `messages`: Text prompt or array of message objects
  - `model` (optional): Model to use (default: 'openai')
  - `system_prompt` (optional): System instructions for the AI
  - `temperature` (optional): Controls randomness (default: 0.7)
  - `max_tokens` (optional): Maximum tokens in the response
  - `private` (optional): If true, response won't appear in public feed

- **Examples:**
```json
{
  "prompt": "Write a short poem about nature",
  "model": "openai",
  "temperature": 0.7,
  "max_tokens": 100
}
```
Or with messages format:
```json
{
  "messages": [
    {"role": "user", "content": "Write a short poem about nature"}
  ],
  "model": "openai"
}
```

### Audio Generation (Text-to-Speech)

`GET https://text.pollinations.ai/{text}?model=openai-audio&voice={voice}`

- **Description:** Convert text to speech
- **Parameters:**
  - `text` (required): Text to convert to speech (URL encoded)
  - `model` (optional): Model to use (default: 'openai-audio')
  - `voice` (optional): Voice to use for generation
    - Options: 'alloy', 'echo', 'fable', 'onyx', 'nova', 'shimmer'

- **Example:**
```
https://text.pollinations.ai/Hello%20world?model=openai-audio&voice=alloy
```

### Audio Transcription

`POST https://text.pollinations.ai/transcriptions`

- **Description:** Transcribe audio to text
- **Body:** Form data with the following fields:
  - `file`: Audio file to transcribe
  - `model` (optional): Model to use (default: 'openai-audio')

- **Response:** JSON with transcribed text

## Feed Endpoints

### Image Feed

`GET https://image.pollinations.ai/feed`

- **Description:** Provides a real-time stream of images generated by users.
- **Usage:** Connect using an SSE-compatible client to receive continuous image data.
- **Example:**

```javascript
const eventSource = new EventSource('https://image.pollinations.ai/feed');

eventSource.onmessage = function(event) {
  const imageData = JSON.parse(event.data);
  console.log('New image generated:', imageData.imageURL);
};
```

### Text Feed

`GET https://text.pollinations.ai/feed`

- **Description:** Provides a real-time stream of text generated by users.
- **Usage:** Connect using an SSE-compatible client to receive continuous text data.
- **Example:**

```javascript
const eventSource = new EventSource('https://text.pollinations.ai/feed');

eventSource.onmessage = function(event) {
  const textData = JSON.parse(event.data);
  console.log('New text generated:', textData);
};
```

## Model Context Protocol (MCP)

### Overview

The Model Context Protocol (MCP) allows AI assistants to generate images and audio directly within text responses using special commands.

### Installation & Usage

```bash
# Run with npx (no installation required)
npx @pollinations/model-context-protocol
```

### MCP Directives

- **Image Generation:** `!generate image: [description]`
- **Audio Generation:** `!generate audio: [text to speak]`

### MCP Node.js Client

```javascript
import { generateImageUrl, generateImage, respondAudio, sayText } from '@pollinations/model-context-protocol';

// Generate an image URL
const imageResult = await generateImageUrl('A beautiful sunset over the ocean', {
  width: 512,
  height: 512,
  model: 'flux.schnell'
});
console.log(imageResult.imageUrl);

// Generate audio from text
const audioResult = await respondAudio('Hello, world!', 'alloy');
// Audio will be played automatically
```

### React Integration

```javascript
import React from 'react';
import { usePollinationsImage } from '@pollinations/react';

const GeneratedImageComponent = () => {
  const imageUrl = usePollinationsImage('A beautiful landscape', {
    width: 1024,
    height: 1024,
    seed: 42,
    model: 'flux'
  });

  return (
    <div>
      {imageUrl ? <img src={imageUrl} alt="Generated Image" /> : <p>Loading...</p>}
    </div>
  );
};
```

## Node.js Integration Examples

### Image Generation

```javascript
import fs from 'fs';
import fetch from 'node-fetch';

async function downloadImage(imageUrl) {
  // Fetching the image from the URL
  const response = await fetch(imageUrl);
  // Reading the response as a buffer
  const buffer = await response.buffer();
  // Writing the buffer to a file named 'image.png'
  fs.writeFileSync('image.png', buffer);
  // Logging completion message
  console.log('Download Completed');
}

// Image details
const prompt = 'A beautiful landscape';
const width = 1024;
const height = 1024;
const seed = 42; // Each seed generates a new image variation
const model = 'flux'; // Using 'flux' as default if model is not provided

const imageUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?width=${width}&height=${height}&seed=${seed}&model=${model}`;

downloadImage(imageUrl);
```

### Text Generation

```javascript
async function generatePrivateText() {
  const response = await fetch('https://text.pollinations.ai/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      messages: [
        { role: 'user', content: 'Generate a creative story' }
      ],
      model: 'openai',
      private: true  // Response won't appear in public feed
    })
  });
  
  const data = await response.text();
  console.log('Generated Text:', data);
}
```

### Audio Generation

```javascript
async function generateAudio() {
  // Simple GET request for text-to-speech
  const text = "Welcome to Pollinations, where creativity blooms!";
  const voice = "nova"; // Optional voice parameter
  const url = "https://text.pollinations.ai/" + encodeURIComponent(text) + "?model=openai-audio&voice=" + voice;
  
  const response = await fetch(url);
  
  // Save the audio file
  const buffer = await response.buffer();
  fs.writeFileSync('generated_audio.mp3', buffer);
  console.log('Audio generated and saved!');
}
```

## Image Generation Tips

### Parameters Guide
- **Prompt:** Description of the desired image (required)
- **Width:** Image width (default: 1024)
- **Height:** Image height (default: 1024)
- **Seed:** Controls randomization for reproducible results
- **Model:** Different models produce different styles
  - `flux`: General purpose (default)
  - `flux-realism`: Photorealistic images
  - `any-dark`: Dark, moody aesthetics
  - `flux-anime`: Anime/manga style
  - `flux-3d`: 3D rendered style
  - `turbo`: Faster generation

### Tips for Better Results
- To create variations of an image without changing its content, keep the prompt the same and change only the seed.
- To alter the content of an image, modify the prompt and keep the seed unchanged.
- For best results, provide detailed descriptions in your prompts (around 50 words).
- Example image markdown format:
  ```
  ![{description}](https://image.pollinations.ai/prompt/{description}?width={width}&height={height})
  *{description}*
  ```
  <html>
  <body>
    <h2>Image Parameters</h2>
    <p>Prompt: A beautiful landscape</p>
    <p>Width: 1024</p>
    <p>Height: 1024</p>
    <p>Seed: 42 <i>Each seed generates a new image variation</i></p>
    <p>Model: flux</p>

    <img 
      src="https://image.pollinations.ai/prompt/A%20beautiful%20landscape" 
      alt="A beautiful landscape"
    />
  </body>
</html>
